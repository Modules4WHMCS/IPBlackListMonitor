!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(a){return t(a,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(e,a){return e||(e=window),void 0===a&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),t(a,e,e.document),a}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,a){"use strict";var i=e.jgrid,o=i.jqID,r=e.fn.jqGrid,l=r.getGuiStyles,n=i.mergeCssClasses,d=i.hasOneFromClasses,s=i.feedback,c=i.fullBoolFeedback,u=i.builderFmButon,p=function(e,t,a){var i;!0===t[0]&&(i="<span class='"+n("fm-button-icon",a,t[2])+"'></span>","right"===t[1]?e.addClass("fm-button-icon-right").append(i):e.addClass("fm-button-icon-left").prepend(i))},f=function(e){return l.call(this,"states."+e)},h=function(t){t.find("tr[data-rowpos]").each(function(){var t=0;e(this).children("td").each(function(){"hidden"!==e(this).css("visibility")&&t++}),t||e(this).hide()})},m=function(e){return"&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0)};i.extend({searchGrid:function(t){return this.each(function(){function a(t){C("beforeShow",t)&&(e(y).data("onClose",m.onClose),i.viewModal.call(d,y,{gbox:w,jqm:m.jqModal,overlay:m.overlay,modal:m.modal,overlayClass:m.overlayClass,toTop:m.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),C("afterShow",t))}var d=this,p=e(d),h=d.p;if(d.grid&&null!=h){var m=e.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:h.prmNames.filters,loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},r.getGridRes.call(p,"search"),i.search||{},h.searching||{},t||{}),v="fbox_"+h.id,g=m.commonIconClass,b={themodal:"searchmod"+v,modalhead:"searchhd"+v,modalcontent:"searchcnt"+v,resizeAlso:v},y="#"+o(b.themodal),w=h.gBox,D=h.gView,x=e.each,k=h.postData[m.sFilter],C=function(){var t=e.makeArray(arguments);return t.unshift("Search"),t.unshift("Filter"),t.unshift(m),s.apply(d,t)},F=function(){i.hideModal(y,{gb:w,jqm:m.jqModal,onClose:m.onClose,removemodal:m.removemodal})};if("string"==typeof k&&(k=""!==e.trim(k)?e.parseJSON(k):void 0),e(y).remove(),void 0!==e(y)[0])a(e("#fbox_"+o(h.id)));else{var _=e("<div><div id='"+v+"' class='"+l.call(d,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(D);"rtl"===h.direction&&_.attr("dir","rtl");var E,S,O="",j="",q=!1,T=-1,A=e.extend([],h.colModel),G=u.call(d,v+"_search",m.Find,n(g,m.findDialogIcon),"right"),I=u.call(d,v+"_reset",m.Reset,n(g,m.resetDialogIcon),"left");if(m.showQuery&&(O=u.call(d,v+"_query","Query",n(g,m.queryDialogIcon),"left")+"&#160;"),m.searchForAdditionalProperties&&x(h.additionalProperties,function(){var e="string"==typeof this?{name:this}:this;e.label||(e.label=e.name),e.isAddProp=!0,A.push(e)}),m.columns.length?(A=m.columns,T=0,E=A[0].index||A[0].name):x(A,function(e,t){if(t.label||(t.label=t.isAddProp?t.name:h.colNames[e]),!q){var a=void 0===t.search||t.search,i=!0===t.hidden;(t.searchoptions&&!0===t.searchoptions.searchhidden&&a||a&&!i)&&(q=!0,E=t.index||t.name,T=e)}}),!k&&E||!1===m.multipleSearch){var B="eq";T>=0&&A[T].searchoptions&&A[T].searchoptions.sopt?B=A[T].searchoptions.sopt[0]:m.sopt&&m.sopt.length&&(B=m.sopt[0]),k={groupOp:"AND",rules:[{field:E,op:B,data:""}]}}q=!1,m.tmplNames&&m.tmplNames.length&&(q=!0,j=m.tmplLabel,j+="<select class='ui-template'>",j+="<option value='default'>Default</option>",x(m.tmplNames,function(e,t){j+="<option value='"+e+"'>"+t+"</option>"}),j+="</select>"),S="<div class='"+l.call(d,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+v+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(d,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+h.direction+"'  style='float:"+("rtl"===h.direction?"right":"left")+";'>"+I+j+"</td><td class='EditButton EditButton-"+h.direction+"'>"+O+G+"</td></tr></tbody></table></div>",v=o(v),m.gbox=w,m.height="auto",e(v="#"+v).jqFilter({columns:A,filter:m.loadDefaults?k:null,showQuery:m.showQuery,errorcheck:m.errorcheck,sopt:m.sopt,groupButton:m.multipleGroup,ruleButtons:m.multipleSearch,afterRedraw:m.afterRedraw,ops:m.odata,cops:h.customSortOperations,operands:m.operands,ajaxSelectOptions:h.ajaxSelectOptions,groupOps:m.groupOps,onChange:function(t,a){t.showQuery&&e(".query",a).text(a.toUserFriendlyString()),c.call(d,m.afterChange,"jqGridFilterAfterChange",e(v),m,t,a)},direction:h.direction,id:h.id}),_.append(S),q&&m.tmplFilters&&m.tmplFilters.length&&e(".ui-template",_).on("change",function(){var t=e(this).val();return"default"===t?e(v).jqFilter("addFilter",k):e(v).jqFilter("addFilter",m.tmplFilters[parseInt(t,10)]),!1}),!0===m.multipleGroup&&(m.multipleSearch=!0),C("onInitialize",e(v)),m.layer?i.createModal.call(d,b,_,m,D,e(w)[0],"#"+o(m.layer),{position:"relative"}):i.createModal.call(d,b,_,m,D,e(w)[0]),(m.searchOnEnter||m.closeOnEscape)&&e(y).keydown(function(t){var a=e(t.target);return!m.searchOnEnter||13!==t.which||a.hasClass("add-group")||a.hasClass("add-rule")||a.hasClass("delete-group")||a.hasClass("delete-rule")||a.hasClass("fm-button")&&a.is("[id$=_query]")?m.closeOnEscape&&27===t.which?(e("#"+o(b.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(e(v+"_search").click(),!1)}),O&&e(v+"_query").on("click",function(){return e(".queryresult",_).toggle(),!1}),void 0===m.stringResult&&(m.stringResult=m.multipleSearch),e(v+"_search").on("click",function(){var t,a={},i="",o=e(v),r=o.find(".input-elm");if(r.filter(":focus")&&(r=r.filter(":focus")),r.change(),t=o.jqFilter("filterData"),m.errorcheck&&(o[0].hideError(),m.showQuery||o.jqFilter("toSQLString"),o[0].p.error))return o[0].showError(),!1;if(m.stringResult||"local"===h.datatype){try{i=JSON.stringify(t)}catch(e){}"string"==typeof i&&(a[m.sFilter]=i,x([m.sField,m.sValue,m.sOper],function(){a[this]=""}))}else m.multipleSearch?(a[m.sFilter]=t,x([m.sField,m.sValue,m.sOper],function(){a[this]=""})):(a[m.sField]=t.rules[0].field,a[m.sValue]=t.rules[0].data,a[m.sOper]=t.rules[0].op,a[m.sFilter]="");return e.extend(h.postData,a),c.call(d,m.onSearch,"jqGridFilterSearch",h.filters)&&(h.search=!0,p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridSearchOptions||{})])),m.closeAfterSearch&&F(),!1}),e(v+"_reset").on("click",function(){var t={},a=e(v);return h.search=!1,h.resetsearch=!0,!1===m.multipleSearch?t[m.sField]=t[m.sValue]=t[m.sOper]="":t[m.sFilter]="",a[0].resetFilter(),q&&e(".ui-template",_).val("default"),e.extend(h.postData,t),c.call(d,m.onReset,"jqGridFilterReset")&&p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridResetOptions||{})]),m.closeAfterReset&&F(),!1}),a(e(v));var N=f.call(d,"hover");e(".fm-button:not(."+f.call(d,"disabled").split(" ").join(".")+")",_).hover(function(){e(this).addClass(N)},function(){e(this).removeClass(N)})}}})},editGridRow:function(t,a){return this.each(function(){function c(){return e(B+" > tbody > tr > td .FormElement").each(function(){var t,a,r,l,n,d=e(".customelement",this),s=this.name;if(d.length){if(s=d.attr("name"),void 0!==(a=V[s])&&(t=z[a],r=t.editoptions||{},e.isFunction(r.custom_value))){try{if(_[s]=r.custom_value.call(k,e("#"+o(s),B),"get"),void 0===_[s])throw"e1"}catch(e){"e1"===e?i.info_dialog.call(k,K,"function 'custom_value' "+T.msg.novalue,T.bClose):i.info_dialog.call(k,K,e.message,T.bClose)}return!0}}else switch(n=e(this)[0].type){case"checkbox":_[s]=e(this).is(":checked")?e(this).val():e(this).data("offval");break;case"select-one":_[s]=e("option:selected",this).val();break;case"select-multiple":_[s]=e(this).val(),_[s]=_[s]?_[s].join(","):"";var c=[];e("option:selected",this).each(function(t,a){c[t]=e(a).text()});break;case"date":_[s]=e(this).val(),3===String(_[s]).split("-").length&&void 0!==(a=V[s])&&(l=((t=z[a]).formatoptions||{}).newformat||j.call(C,"formatter.date.newformat"),_[s]=i.parseDate.call(C[0],"Y-m-d",_[s],l));break;default:void 0!==n&&e.inArray(n,T.skipPostTypes)<0&&(_[s]=e(this).val())}}),!0}function v(t,a){var l,n,d,s,c,u=0;(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData={},T._savedData[O+"_id"]=t);var p=F.colModel;if("_empty"===t)return e(p).each(function(){l=this.name,d=e.extend({},this.editoptions||{}),(n=e("#"+o(l),a))&&n.length&&null!==n[0]&&(s="","custom"===this.edittype&&e.isFunction(d.custom_value)?d.custom_value.call(k,n,"set",s):d.defaultValue?(s=e.isFunction(d.defaultValue)?d.defaultValue.call(k):d.defaultValue,"checkbox"===n[0].type?(c=s.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==c?(n[0].checked=!0,n[0].defaultChecked=!0,n[0].value=s):(n[0].checked=!1,n[0].defaultChecked=!1):n.val(s)):"checkbox"===n[0].type?(n[0].checked=!1,n[0].defaultChecked=!1,s=e(n).data("offval")):n[0].type&&"select"===n[0].type.substr(0,6)?n[0].selectedIndex=0:n.val(s),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[l]=s))}),void e("#id_g",a).val(t);var f=r.getInd.call(C,t,!0);f&&(e(f.cells).filter("td[role=gridcell]").each(function(r){var n;if("cb"!==(l=p[r].name)&&"subgrid"!==l&&"rn"!==l&&!0===p[r].editable){try{n=e.unformat.call(k,e(this),{rowId:t,colModel:p[r]},r)}catch(t){n="textarea"===p[r].edittype?e(this).text():e(this).html()}switch(F.autoEncodeOnEdit&&(n=i.oldDecodePostedData(n)),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[l]=n),l="#"+o(l),p[r].edittype){case"password":case"text":case"button":case"image":case"textarea":m(n)&&(n=""),e(l,a).val(n);break;case"select":var d=n.split(",");d=e.map(d,function(t){return e.trim(t)}),e(l+" option",a).each(function(){var t=this,a=e(t),i=e.trim(a.val()),o=e.trim(a.text());p[r].editoptions.multiple||e.trim(n)!==o&&d[0]!==o&&d[0]!==i?p[r].editoptions.multiple&&(e.inArray(o,d)>-1||e.inArray(i,d)>-1)?t.selected=!0:t.selected=!1:t.selected=!0});break;case"checkbox":n=String(n),p[r].editoptions&&p[r].editoptions.value?n=p[r].editoptions.value.split(":")[0]===n:(n=n.toLowerCase(),n=n.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==n),e(l,a).prop({checked:n,defaultChecked:n});break;case"custom":try{if(!p[r].editoptions||!e.isFunction(p[r].editoptions.custom_value))throw"e1";p[r].editoptions.custom_value.call(k,e(l,a),"set",n)}catch(e){"e1"===e?i.info_dialog.call(k,K,"function 'custom_value' "+T.msg.nodefined,T.bClose):i.info_dialog.call(k,K,e.message,T.bClose)}}u++}}),u>0&&e("#id_g",B).val(t))}function g(){var t=T.url||F.editurl;e.each(z,function(a,i){var o=i.name,r=_[o];"date"!==i.formatter||null!=i.formatoptions&&!0===i.formatoptions.sendFormatted||(_[o]=e.unformat.date.call(k,r,i)),"clientArray"!==t&&i.editoptions&&!0===i.editoptions.NullIfEmpty&&_.hasOwnProperty(o)&&""===r&&(_[o]="null")})}function b(){var a,o,l,n,d,s,c,u,p=[!0,"",""],f=p,h={},m=F.prmNames,b=r.getInd.call(C,t),y=!1===b?null:k.rows[b],w=C.triggerHandler("jqGridAddEditBeforeCheckValues",[_,e(A),S]);w&&"object"==typeof w&&(_=w),b=!1===b?-1:b,e.isFunction(T.beforeCheckValues)&&(w=T.beforeCheckValues.call(k,_,e(A),S))&&"object"==typeof w&&(_=w);for(l in _)if(_.hasOwnProperty(l)&&(u=F.iColByName[l],null!=(f=i.checkValues.call(k,_[l],l,void 0,void 0,{oldValue:"_empty"===t?null:r.getCell.call(C,t,u),newValue:_[l],cmName:l,rowid:t,cm:z[u],iCol:u,iRow:b,tr:y,td:null==y?null:y.cells[u],mode:"_empty"===t?"addForm":"editForm"}))&&!0!==f||(f=p),!1===f[0]))break;if(g(),f[0]&&(void 0===(h=C.triggerHandler("jqGridAddEditClickSubmit",[T,_,S]))&&e.isFunction(T.onclickSubmit)&&(h=T.onclickSubmit.call(k,T,_,S)||{}),null!=(f=C.triggerHandler("jqGridAddEditBeforeSubmit",[_,e(A),S]))&&!0!==f||(f=p),f[0]&&e.isFunction(T.beforeSubmit)&&(null!=(f=T.beforeSubmit.call(k,_,e(A),S))&&!0!==f||(f=p))),f[0]&&!T.processing){if(T.processing=!0,e("#sData",N).addClass($),s=T.url||F.editurl,o=m.oper,a="clientArray"===s&&!1!==F.keyName?F.keyName:m.id,_[o]="_empty"===e.trim(_[O+"_id"])?m.addoper:m.editoper,_[o]!==m.addoper?_[a]=_[O+"_id"]:void 0===_[a]&&(_[a]=_[O+"_id"]),delete _[O+"_id"],_=e.extend(_,T.editData,h),!0===F.treeGrid){if(_[o]===m.addoper){n=F.selrow;var D="adjacency"===F.treeGridModel?F.treeReader.parent_id_field:"parent_id";_[D]=n}for(d in F.treeReader)if(F.treeReader.hasOwnProperty(d)&&(c=F.treeReader[d],_.hasOwnProperty(c))){if(_[o]===m.addoper&&"parent_id_field"===d)continue;delete _[c]}}_[a]=i.stripPref(F.idPrefix,_[a]),F.autoEncodeOnEdit&&e.each(_,function(t,a){e.isFunction(a)||(_[t]=i.oldEncodePostedData(a))});var x=e.extend({url:e.isFunction(s)?s.call(k,_[a],S,_,T):s,type:e.isFunction(T.mtype)?T.mtype.call(k,S,T,_[a],_):T.mtype,data:i.serializeFeedback.call(k,e.isFunction(T.serializeEditData)?T.serializeEditData:F.serializeEditData,"jqGridAddEditSerializeEditData",_),complete:function(t,l){if(C.jqGrid("progressBar",{method:"hide",loadtype:T.saveui}),e("#sData",N).removeClass($),_[a]=e("#id_g",B).val(),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(f[0]=!1,f[1]=C.triggerHandler("jqGridAddEditErrorTextFormat",[t,S]),e.isFunction(T.errorTextFormat)?f[1]=T.errorTextFormat.call(k,t,S):f[1]=l+" Status: '"+t.statusText+"'. Error code: "+t.status):(null!=(f=C.triggerHandler("jqGridAddEditAfterSubmit",[t,_,S]))&&!0!==f||(f=p),f[0]&&e.isFunction(T.afterSubmit)&&(null!=(f=T.afterSubmit.call(k,t,_,S))&&!0!==f||(f=p))),!1===f[0])e("#FormError>td",B).html(f[1]),e("#FormError",B).show();else{F.autoEncodeOnEdit&&e.each(_,function(e,t){_[e]=i.oldDecodePostedData(t)});var d=[e.extend({},T.reloadGridOptions||{})];if(_[o]===m.addoper?(f[2]||(f[2]=i.randId()),null==_[a]||"_empty"===_[a]||_[o]===m.addoper?_[a]=f[2]:f[2]=_[a],T.reloadAfterSubmit?C.trigger("reloadGrid",d):!0===F.treeGrid?r.addChildNode.call(C,f[2],n,_):r.addRowData.call(C,f[2],_,T.addedrow),T.closeAfterAdd?(!0!==F.treeGrid&&q.call(C,f[2]),Q()):T.clearAfterAdd&&v("_empty",A)):(T.reloadAfterSubmit?(C.trigger("reloadGrid",d),T.closeAfterEdit||setTimeout(function(){q.call(C,_[a])},1e3)):!0===F.treeGrid?r.setTreeRow.call(C,_[a],_):r.setRowData.call(C,_[a],_),T.closeAfterEdit&&Q()),e.isFunction(T.afterComplete)){var s=t;setTimeout(function(){C.triggerHandler("jqGridAddEditAfterComplete",[s,_,e(A),S]),T.afterComplete.call(k,s,_,e(A),S),s=null},50)}if((T.checkOnSubmit||T.checkOnUpdate)&&(e(A).data("disabled",!1),"_empty"!==T._savedData[O+"_id"])){var c;for(c in T._savedData)T._savedData.hasOwnProperty(c)&&_[c]&&(T._savedData[c]=_[c])}}T.processing=!1;try{e(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(e){}}},i.ajaxOptions,T.ajaxEditOptions);if(x.url||T.useDataProxy||(e.isFunction(F.dataProxy)?T.useDataProxy=!0:(f[0]=!1,f[1]+=" "+i.errors.nourl)),f[0])if(C.jqGrid("progressBar",{method:"show",loadtype:T.saveui,htmlcontent:T.savetext}),T.useDataProxy){var E=F.dataProxy.call(k,x,"set_"+O);void 0===E&&(E=[!0,""]),!1===E[0]?(f[0]=!1,f[1]=E[1]||"Error deleting the selected row!"):(x.data.oper===m.addoper&&T.closeAfterAdd&&Q(),x.data.oper===m.editoper&&T.closeAfterEdit&&Q())}else"clientArray"===x.url?(T.reloadAfterSubmit=!1,_=x.data,x.complete({status:200,statusText:""},"")):e.ajax(x)}!1===f[0]&&(e("#FormError>td",B).html(f[1]),e("#FormError",B).show())}function y(e,t){var a,i=!1;for(a in e)if(e.hasOwnProperty(a)&&String(e[a])!==String(t[a])){i=!0;break}return i}function w(){var t=!0;return e("#FormError",B).hide(),T.checkOnUpdate&&(_={},c(),(E=y(_,T._savedData))&&(e(A).data("disabled",!0),e(".confirm",R).show(),t=!1)),t}function D(t,a){var i=a[1].length-1;0===t?e("#pData",N).addClass(X):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),X)?e("#pData",N).addClass(X):e("#pData",N).removeClass(X),t===i?e("#nData",N).addClass(X):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),X)?e("#nData",N).addClass(X):e("#nData",N).removeClass(X)}function x(){var t=r.getDataIDs.call(C),a=e("#id_g",B).val();return[e.inArray(a,t),t]}var k=this,C=e(k),F=k.p;if(k.grid&&null!=F&&t){var _,E,S,O=F.id,j=r.getGridRes,q=r.setSelection,T=e.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:l.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:j.call(C,"defaults.savetext")||"Saving..."},j.call(C,"edit"),i.edit,F.formEditing||{},a||{}),A="FrmGrid_"+O,G=A,I="TblGrid_"+O,B="#"+o(I),N=B+"_2",P={themodal:"editmod"+O,modalhead:"edithd"+O,modalcontent:"editcnt"+O,resizeAlso:A},R="#"+o(P.themodal),M=F.gBox,z=F.colModel,V=F.iColByName,L=1,U=0,H=T.commonIconClass,Q=function(){i.hideModal(R,{gb:M,jqm:T.jqModal,onClose:T.onClose,removemodal:T.removemodal})},K=j.call(C,"errors.errcap"),W=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("AddEdit"),t.unshift(T),s.apply(k,t)},J=f.call(k,"hover"),X=f.call(k,"disabled"),Y=f.call(k,"select"),$=f.call(k,"active"),Z=f.call(k,"error");e(R).remove(),A="#"+o(A),"new"===t?(t="_empty",S="add",T.caption=T.addCaption):(T.caption=T.editCaption,S="edit");var ee=!0;!T.checkOnUpdate||!0!==T.jqModal&&void 0!==T.jqModal||T.modal||(ee=!1);var te=isNaN(T.dataheight)?T.dataheight:T.dataheight+"px",ae=isNaN(T.datawidth)?T.datawidth:T.datawidth+"px",ie=e("<form name='FormPost' id='"+G+"' class='FormGrid' onSubmit='return false;' style='width:"+ae+";overflow:auto;position:relative;height:"+te+";'></form>").data("disabled",!1),oe=e("<table id='"+I+"' class='EditTable'><tbody></tbody></table>");e(z).each(function(){var e=this.formoptions;L=Math.max(L,e?e.colpos||0:0),U=Math.max(U,e?e.rowpos||0:0)}),e(ie).append(oe);var re=e("<tr id='FormError' style='display:none'><td class='"+Z+"' colspan='"+2*L+"'>&#160;</td></tr>");if(re[0].rp=0,e(oe).append(re),re=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*L+"'>"+(T.topinfo||"&#160;")+"</td></tr>"),re[0].rp=0,e(oe).append(re),W("beforeInitData",ie,S)){!function(){var a=i.detectRowEditing.call(k,t);if(null!=a)if("inlineEditing"===a.mode)r.restoreRow.call(C,t);else{var o=a.savedRow,l=k.rows[o.id];r.restoreCell.call(C,o.id,o.ic),e(l.cells[o.ic]).removeClass("edit-cell "+Y),e(l).addClass(Y).attr({"aria-selected":"true",tabindex:"0"})}}();var le="rtl"===F.direction,ne=le?"nData":"pData",de=le?"pData":"nData";!function(t,a,n){var d,s=0,c=[],u=!1,p=e(a),f="";for(d=1;d<=n;d++)f+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==t&&(u=r.getInd.call(C,t)),e(z).each(function(a){var r,d,h,v,g,b=this,y=b.name,w=b.editable,D=!1,x=!1,C="_empty"===t?"addForm":"editForm";switch(e.isFunction(w)&&(w=w.call(k,{rowid:t,iCol:a,iRow:u,cmName:y,cm:b,mode:C})),d=!(b.editrules&&!0===b.editrules.edithidden||!0!==b.hidden&&"hidden"!==w),String(w).toLowerCase()){case"hidden":w=!0;break;case"disabled":w=!0,D=!0;break;case"readonly":w=!0,x=!0}if("cb"!==y&&"subgrid"!==y&&!0===w&&"rn"!==y){if(!1===u)v="";else{r=e(k.rows[u].cells[a]);try{v=e.unformat.call(k,r,{rowId:t,colModel:b},a)}catch(e){v=b.edittype&&"textarea"===b.edittype?r.text():r.html()}m(v)&&(v="")}var _=e.extend({},b.editoptions||{},{id:y,name:y,rowId:t,mode:C,cm:b,iCol:a}),E=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},b.formoptions||{}),S=parseInt(E.rowpos,10)||s+1,O=parseInt(2*(parseInt(E.colpos,10)||1),10);if("_empty"===t&&_.defaultValue&&(v=e.isFunction(_.defaultValue)?_.defaultValue.call(k):_.defaultValue),b.edittype||(b.edittype="text"),F.autoEncodeOnEdit&&(v=i.oldDecodePostedData(v)),g=i.createEl.call(k,b.edittype,_,v,!1,e.extend({},i.ajaxOptions,F.ajaxSelectOptions||{})),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[y]=v),e(g).addClass("FormElement"),e.inArray(b.edittype,["text","textarea","checkbox","password","select"])>-1&&e(g).addClass(l.call(k,"dialog.dataField")),h=p.find("tr[data-rowpos="+S+"]"),E.rowabove){var j=e("<tr><td class='contentinfo' colspan='"+2*n+"'>"+E.rowcontent+"</td></tr>");p.append(j),j[0].rp=S}0===h.length&&(h=e("<tr data-rowpos='"+S+"'></tr>").addClass("FormData").attr("id","tr_"+y),e(h).append(f),p.append(h),h[0].rp=S);var q=e("td:eq("+(O-2)+")",h[0]),G=e("td:eq("+(O-1)+")",h[0]);q.html(void 0===E.label?F.colNames[a]:E.label||"&#160;"),G[m(G.html())?"html":"append"](E.elmprefix).append(g).append(E.elmsuffix),D?(q.addClass(X),G.addClass(X),e(g).prop("readonly",!0),e(g).prop("disabled",!0)):x&&e(g).prop("readonly",!0),"custom"===b.edittype&&e.isFunction(_.custom_value)&&_.custom_value.call(k,e("#"+o(y),A),"set",v),i.bindEv.call(k,g,_),d&&q.add(G).css("visibility","hidden"),c[s]=a,s++}}),h(p),s>0){var v=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*n-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+O+"_id' value='"+t+"'/></td></tr>");v[0].rp=s+999,p.append(v),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[O+"_id"]=t)}}(t,oe,L);var se=u.call(k,ne,"",n(H,T.prevIcon),"","left"),ce=u.call(k,de,"",n(H,T.nextIcon),"","right"),ue=u.call(k,"sData",T.bSubmit),pe=u.call(k,"cData",T.bCancel),fe="<div class='"+l.call(k,"dialog.footer")+"'><table class='EditTable' id='"+I+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(k,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+F.direction+"'>"+(le?ce+se:se+ce)+"</td><td class='EditButton EditButton-"+F.direction+"'>"+ue+"&#160;"+pe+"</td></tr>";if(fe+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(T.bottominfo||"&#160;")+"</td></tr>",fe+="</tbody></table></div>",U>0){var he=[];e.each(e(oe)[0].rows,function(e,t){he[e]=t}),he.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(he,function(t,a){e("tbody",oe).append(a)})}T.gbox=M;var me=!1;!0===T.closeOnEscape&&(T.closeOnEscape=!1,me=!0);var ve=e("<div></div>").append(e("<div class='"+l.call(k,"dialog.body")+"'></div>").append(ie)).append(fe);if(i.createModal.call(k,P,ve,T,F.gView,e(M)[0]),T.topinfo&&e(".tinfo",B).show(),T.bottominfo&&e(".binfo",N).show(),ve=null,fe=null,e(R).keydown(function(t){var a,i,o=(t.target.tagName||"").toUpperCase();if(!0===e(A).data("disabled"))return!1;if(13===t.which&&"TEXTAREA"!==o){if(a=e(N).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0)return a.trigger("click"),!1;if(!0===T.savekey[0]&&13===T.savekey[1])return e("#sData",N).trigger("click"),!1}if(!0===T.savekey[0]&&t.which===T.savekey[1]&&"TEXTAREA"!==o)return e("#sData",N).trigger("click"),!1;if(27===t.which)return!!w()&&(me&&Q(),!1);if(!0===T.navkeys[0]){if("_empty"===e("#id_g",B).val())return!0;if(t.which===T.navkeys[1])return e("#pData",N).trigger("click"),!1;if(t.which===T.navkeys[2])return e("#nData",N).trigger("click"),!1}}),T.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span",R).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close",R).off("click").click(function(){return!!w()&&(Q(),!1)})),p(e("#sData",N),T.saveicon,H),p(e("#cData",N),T.closeicon,H),T.checkOnSubmit||T.checkOnUpdate){ue=u.call(k,"sNew",T.bYes),ce=u.call(k,"nNew",T.bNo),pe=u.call(k,"cNew",T.bExit);var ge=T.zIndex||999;ge++,e("<div class='"+T.overlayClass+" jqgrid-overlay confirm' style='z-index:"+ge+";display:none;'>&#160;</div><div class='"+l.call(k,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(ge+1)+"'>"+T.saveData+"<br/><br/>"+ue+ce+pe+"</div>").insertAfter(A),e("#sNew",R).click(function(){return b(),e(A).data("disabled",!1),e(".confirm",R).hide(),!1}),e("#nNew",R).click(function(){return e(".confirm",R).hide(),e(A).data("disabled",!1),setTimeout(function(){e(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),e("#cNew",R).click(function(){return e(".confirm",R).hide(),e(A).data("disabled",!1),Q(),!1})}W("onInitializeForm",e(A),S),"_empty"!==t&&T.viewPagerButtons?e("#pData,#nData",N).show():e("#pData,#nData",N).hide(),W("beforeShowForm",e(A),S),e(R).data("onClose",T.onClose),i.viewModal.call(k,R,{gbox:M,jqm:T.jqModal,overlay:T.overlay,modal:T.modal,overlayClass:T.overlayClass,toTop:T.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),ee||e("."+o(T.overlayClass)).click(function(){return!!w()&&(Q(),!1)}),e(".fm-button",R).hover(function(){e(this).addClass(J)},function(){e(this).removeClass(J)}),e("#sData",N).click(function(){return _={},e("#FormError",B).hide(),c(),"_empty"===_[O+"_id"]?b():!0===T.checkOnSubmit&&(E=y(_,T._savedData))?(e(A).data("disabled",!0),e(".confirm",R).show()):b(),!1}),e("#cData",N).click(function(){return!!w()&&(Q(),!1)}),e("#nData",N).click(function(){if(!w())return!1;e("#FormError",B).hide();var t=x();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!W("onclickPgButtons","next",e(A),t[1][t[0]]))return!1;v(t[1][t[0]+1],A),q.call(C,t[1][t[0]+1]),W("afterclickPgButtons","next",e(A),t[1][t[0]+1]),D(t[0]+1,t)}return!1}),e("#pData",N).click(function(){if(!w())return!1;e("#FormError",B).hide();var t=x();if(-1!==t[0]&&t[1][t[0]-1]){if(!W("onclickPgButtons","prev",e(A),t[1][t[0]]))return!1;if(d(e("#"+o(t[1][t[0]-1])),X))return!1;v(t[1][t[0]-1],A),q.call(C,t[1][t[0]-1]),W("afterclickPgButtons","prev",e(A),t[1][t[0]-1]),D(t[0]-1,t)}return!1}),W("afterShowForm",e(A),S);var be=x();D(be[0],be)}}})},viewGridRow:function(t,a){return this.each(function(){function c(){!0!==k.closeOnEscape&&!0!==k.navkeys[0]||setTimeout(function(){e("#cData").focus()},0)}function v(t){var a,l,n=0,d=r.getInd.call(w,t,!0);d&&(e("td",d).each(function(t){l=A[t],"cb"!==(a=l.name)&&"subgrid"!==a&&"rn"!==a&&(a=o("v_"+a),e("#"+a+" span",F).html(i.getDataFieldOfCell.call(y,d,t).html()),n++)}),n>0&&e("#id_g",F).val(t))}function g(t,a){var i=a[1].length-1;0===t?e("#pData",_).addClass(R):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),R)?e("#pData",_).addClass(R):e("#pData",_).removeClass(R),t===i?e("#nData",_).addClass(R):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),R)?e("#nData",_).addClass(R):e("#nData",_).removeClass(R)}function b(){var t=r.getDataIDs.call(w),a=e("#id_g",F).val();return[e.inArray(a,t),t]}var y=this,w=e(y),D=y.p;if(y.grid&&null!=D&&t){var x=D.id,k=e.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},r.getGridRes.call(w,"view"),i.view||{},D.formViewing||{},a||{}),C="#ViewGrid_"+o(x),F="#ViewTbl_"+o(x),_=F+"_2",E="ViewGrid_"+x,S="ViewTbl_"+x,O=k.commonIconClass,j={themodal:"viewmod"+x,modalhead:"viewhd"+x,modalcontent:"viewcnt"+x,resizeAlso:E},q="#"+o(j.themodal),T=D.gBox,A=D.colModel,G=1,I=0,B=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("View"),t.unshift(k),s.apply(y,t)},N=function(){i.hideModal(q,{gb:T,jqm:k.jqModal,onClose:k.onClose,removemodal:k.removemodal})},P=f.call(y,"hover"),R=f.call(y,"disabled"),M=isNaN(k.dataheight)?k.dataheight:k.dataheight+"px",z=isNaN(k.datawidth)?k.datawidth:k.datawidth+"px",V=e("<div class='"+l.call(y,"dialog.body")+"'><form name='FormPost' id='"+E+"' class='FormGrid' style='width:"+z+";overflow:auto;position:relative;height:"+M+";'></form></div>"),L=V.children("form.FormGrid"),U=e("<table id='"+S+"' class='EditTable'><tbody></tbody></table>");if(e(q).remove(),e(A).each(function(){var e=this.formoptions;G=Math.max(G,e?e.colpos||0:0),I=Math.max(I,e?e.rowpos||0:0)}),L.append(U),B("beforeInitData",L)){!function(t,a,o){var n,d,s,c,u,p,f,v,g=0,b=[],x=r.getInd.call(w,t),C=l.call(y,"dialog.viewData"),F=e(a),_=l.call(y,"dialog.viewLabel"),E=String(k.labelswidth)+(!k.labelswidth||isNaN(k.labelswidth)?"":"px"),S="<td class='"+l.call(y,"dialog.viewCellLabel","CaptionTD form-view-label")+(E?"' style='width:"+E+";":"")+"'>&#160;</td><td class='"+l.call(y,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",O="",j=["integer","number","currency"],q=0,T=0;for(u=0;u<o;u++)O+=S;if(e(A).each(function(){var t=this;(d=(!t.editrules||!0!==t.editrules.edithidden)&&!0===t.hidden)||"right"!==t.align||(t.formatter&&-1!==e.inArray(t.formatter,j)?q=Math.max(q,parseInt(t.width,10)):T=Math.max(T,parseInt(t.width,10)))}),p=0!==q?q:0!==T?T:0,e(A).each(function(t){var a=this;if(n=a.name,f=!1,d=(!a.editrules||!0!==a.editrules.edithidden)&&!0===a.hidden,v="boolean"!=typeof a.viewable||a.viewable,"cb"!==n&&"subgrid"!==n&&"rn"!==n&&v){c=!1===x?"":i.getDataFieldOfCell.call(y,y.rows[x],t).html(),f="right"===a.align&&0!==p;var r=e.extend({},{rowabove:!1,rowcontent:""},a.formoptions||{}),l=parseInt(r.rowpos,10)||g+1,u=parseInt(2*(parseInt(r.colpos,10)||1),10);if(r.rowabove){var h=e("<tr><td class='contentinfo' colspan='"+2*o+"'>"+r.rowcontent+"</td></tr>");F.append(h),h[0].rp=l}0===(s=F.find("tr[data-rowpos="+l+"]")).length&&((s=e("<tr data-rowpos='"+l+"'></tr>").addClass("FormData").attr("id","trv_"+n)).append(O),F.append(s),s[0].rp=l);var w=void 0===r.label?D.colNames[t]:r.label,k=e("td:eq("+(u-1)+")",s[0]),E=e("td:eq("+(u-2)+")",s[0]);E.html("<label for='"+n+"'"+(_?" class='"+_+"'>":">")+(w||"&nbsp;")+"</label>"),k[m(k.html())?"html":"append"]("<span id='"+n+"'"+(C?" class='"+C+"'>":">")+(c||"&nbsp;")+"</span>").attr("id","v_"+n),f&&e("td:eq("+(u-1)+") span",s[0]).css({"text-align":"right",width:p+"px"}),d&&E.add(k).css("visibility","hidden"),b[g]=t,g++}}),h(F),g>0){var G=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*o-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");G[0].rp=g+99,F.append(G)}}(t,U,G);var H="rtl"===D.direction,Q=H?"nData":"pData",K=H?"pData":"nData",W=u.call(y,Q,"",n(O,k.prevIcon),"","left"),J=u.call(y,K,"",n(O,k.nextIcon),"","right"),X=u.call(y,"cData",k.bClose);if(I>0){var Y=[];e.each(e(U)[0].rows,function(e,t){Y[e]=t}),Y.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(Y,function(t,a){e("tbody",U).append(a)})}k.gbox=T;var $=e("<div></div>").append(V).append("<div class='"+l.call(y,"dialog.footer")+"'><table border='0' class='EditTable' id='"+S+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+D.direction+"' width='"+(k.labelswidth||"auto")+"'>"+(H?J+W:W+J)+"</td><td class='EditButton EditButton-"+D.direction+"'>"+X+"</td></tr></tbody></table></div>");i.createModal.call(y,j,$,k,D.gView,e(D.gView)[0]),k.viewPagerButtons||e("#pData, #nData",_).hide(),$=null,e(q).keydown(function(t){var a,i;if(!0===e(C).data("disabled"))return!1;if(13===t.which&&(a=e(_).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0))return a.trigger("click"),!1;if(27===t.which)return k.closeOnEscape&&N(),!1;if(!0===k.navkeys[0]){if(t.which===k.navkeys[1])return e("#pData",_).trigger("click"),!1;if(t.which===k.navkeys[2])return e("#nData",_).trigger("click"),!1}}),p(e("#cData",_),k.closeicon,O),B("beforeShowForm",e(C)),i.viewModal.call(y,q,{gbox:T,jqm:k.jqModal,overlay:k.overlay,toTop:k.toTop,modal:k.modal,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),e(".fm-button:not(."+R.split(" ").join(".")+")",_).hover(function(){e(this).addClass(P)},function(){e(this).removeClass(P)}),c(),e("#cData",_).click(function(){return N(),!1}),e("#nData",_).click(function(){e("#FormError",F).hide();var t=b();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!B("onclickPgButtons","next",e(C),t[1][t[0]]))return!1;v(t[1][t[0]+1]),r.setSelection.call(w,t[1][t[0]+1]),B("afterclickPgButtons","next",e(C),t[1][t[0]+1]),g(t[0]+1,t)}return c(),!1}),e("#pData",_).click(function(){e("#FormError",F).hide();var t=b();if(-1!==t[0]&&t[1][t[0]-1]){if(!B("onclickPgButtons","prev",e(C),t[1][t[0]]))return!1;v(t[1][t[0]-1]),r.setSelection.call(w,t[1][t[0]-1]),B("afterclickPgButtons","prev",e(C),t[1][t[0]-1]),g(t[0]-1,t)}return c(),!1});var Z=b();g(Z[0],Z)}}})},delGridRow:function(t,a){return this.each(function(){var n=this,d=n.p,c=e(n);if(n.grid&&null!=d&&t){var h,m,v,g,b=d.id,y=e.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},r.getGridRes.call(c,"del"),i.del||{},d.formDeleting||{},a||{}),w="DelTbl_"+b,D="#DelTbl_"+o(b),x={themodal:"delmod"+b,modalhead:"delhd"+b,modalcontent:"delcnt"+b,resizeAlso:w},k="#"+o(x.themodal),C=d.gBox,F=y.commonIconClass,_=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("Delete"),t.unshift(y),s.apply(n,t)},E=f.call(n,"hover"),S=f.call(n,"active"),O=f.call(n,"error");if(e.isArray(t)||(t=[String(t)]),void 0!==e(k)[0]){if(!_("beforeInitData",e(D)))return;e("#DelData>td",D).text(t.join()).data("rowids",t),e("#DelError",D).hide(),!0===y.processing&&(y.processing=!1,e("#dData",D).removeClass(S)),_("beforeShowForm",e(D)),i.viewModal.call(n,k,{gbox:C,jqm:y.jqModal,jqM:!1,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(D))}else{var j=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",q=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",T="<div class='"+l.call(n,"dialog.body")+"'><div id='"+w+"' class='formdata' style='width:"+q+";overflow:auto;position:relative;height:"+j+";'>";T+="<table class='DelTable'><tbody>",T+="<tr id='DelError' style='display:none'><td class='"+O+"'></td></tr>",T+="<tr id='DelData' style='display:none'><td >"+t.join()+"</td></tr>",T+="<tr><td class='delmsg'>"+y.msg+"</td></tr>",T+="</tbody></table></div></div>";var A=u.call(n,"dData",y.bSubmit),G=u.call(n,"eData",y.bCancel);if(T+="<div class='"+l.call(n,"dialog.footer")+"'><table class='EditTable' id='"+w+"_2'><tbody><tr><td><hr class='"+l.call(n,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+d.direction+"'>"+A+"&#160;"+G+"</td></tr></tbody></table></div>",y.gbox=C,i.createModal.call(n,x,T,y,d.gView,e(d.gView)[0]),e("#DelData>td",D).data("rowids",t),!_("beforeInitData",e(T)))return;e(".fm-button",D+"_2").hover(function(){e(this).addClass(E)},function(){e(this).removeClass(E)}),p(e("#dData",D+"_2"),y.delicon,F),p(e("#eData",D+"_2"),y.cancelicon,F),e("#dData",D+"_2").click(function(){var t,a=[!0,""],o=e("#DelData>td",D),l=o.text(),s=o.data("rowids"),u={};if(e.isFunction(y.onclickSubmit)&&(u=y.onclickSubmit.call(n,y,l)||{}),e.isFunction(y.beforeSubmit)&&(a=y.beforeSubmit.call(n,l)||a),a[0]&&!y.processing){if(y.processing=!0,v=d.prmNames,h=e.extend({},y.delData,u),g=v.oper,h[g]=v.deloper,m=v.id,!(l=s.slice()).length)return!1;for(t in l)l.hasOwnProperty(t)&&(l[t]=i.stripPref(d.idPrefix,l[t]));h[m]=l.join(),e(this).addClass(S);var p=y.url||d.editurl,f=e.extend({url:e.isFunction(p)?p.call(n,h[m],h,y):p,type:y.mtype,data:e.isFunction(y.serializeDelData)?y.serializeDelData.call(n,h):h,complete:function(t,o){var u;if(e("#dData",D+"_2").removeClass(S),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(a[0]=!1,e.isFunction(y.errorTextFormat)?a[1]=y.errorTextFormat.call(n,t):a[1]=o+" Status: '"+t.statusText+"'. Error code: "+t.status):e.isFunction(y.afterSubmit)&&(a=y.afterSubmit.call(n,t,h)||[!0]),!1===a[0])e("#DelError>td",D).html(a[1]),e("#DelError",D).show();else{if("local"===d.datatype||!0===d.treeGrid||!y.reloadAfterSubmit)if(!0===d.treeGrid)try{r.delTreeNode.call(c,s[0])}catch(e){}else for(s=s.slice(),u=0;u<s.length;u++)r.delRowData.call(c,s[u]);y.reloadAfterSubmit&&c.trigger("reloadGrid",[e.extend({},y.reloadGridOptions||{})]),setTimeout(function(){_("afterComplete",t,l,e(D))},50)}y.processing=!1,a[0]&&i.hideModal(k,{gb:C,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}},i.ajaxOptions,y.ajaxDelOptions);if(f.url||y.useDataProxy||(e.isFunction(d.dataProxy)?y.useDataProxy=!0:(a[0]=!1,a[1]+=" "+i.errors.nourl)),a[0])if(y.useDataProxy){var w=d.dataProxy.call(n,f,"del_"+b);void 0===w&&(w=[!0,""]),!1===w[0]?(a[0]=!1,a[1]=w[1]||"Error deleting the selected row!"):i.hideModal(k,{gb:C,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}else"clientArray"===f.url?(h=f.data,f.complete({status:200,statusText:""},"")):e.ajax(f)}return!1===a[0]&&(e("#DelError>td",D).html(a[1]),e("#DelError",D).show()),!1}),e("#eData",D+"_2").click(function(){return i.hideModal(k,{gb:C,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal}),!1}),_("beforeShowForm",e(D)),i.viewModal.call(n,k,{gbox:C,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(D))}!0===y.closeOnEscape&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+o(x.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(s,c,u,p,h,m,v){return"object"==typeof s&&(v=m,m=h,h=p,p=u,u=c,c=s,s=void 0),p=p||{},u=u||{},v=v||{},h=h||{},m=m||{},this.each(function(){var g=this,b=g.p,y=e(g);if(g.grid&&null!=b&&!(g.nav&&e(s).find(".navtable").length>0)){var w=b.id,D=e.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},r.getGridRes.call(y,"nav"),i.nav||{},b.navOptions||{},c||{});D.position=D.position||("rtl"===b.direction?"right":"left");var x,k,C,F=b.idSel,_=b.gBox,E=D.commonIconClass,S={themodal:"alertmod_"+w,modalhead:"alerthd_"+w,modalcontent:"alertcnt_"+w},O=function(){return function(){var r=a.documentElement,n=t,d=1024,s=768,c=y.closest(".ui-jqgrid").offset();void 0===e("#"+o(S.themodal))[0]&&(D.alerttop||D.alertleft||(void 0!==n.innerWidth?(d=n.innerWidth,s=n.innerHeight):null!=r&&void 0!==r.clientWidth&&0!==r.clientWidth&&(d=r.clientWidth,s=r.clientHeight),d=d/2-parseInt(D.alertwidth,10)/2-c.left,s=s/2-25-c.top),i.createModal.call(g,S,"<div class='"+l.call(g,"dialog.body")+"'><div>"+D.alerttext+"</div></div>",{gbox:_,jqModal:D.jqModal,drag:!0,resize:!0,caption:D.alertcap,top:null!=D.alerttop?D.alerttop:s,left:null!=D.alertleft?D.alertleft:d,width:D.alertwidth,height:D.alertheight,closeOnEscape:D.closeOnEscape,zIndex:D.alertzIndex,removemodal:D.removemodal},b.gView,e(_)[0],!1)),i.viewModal.call(g,"#"+o(S.themodal),{gbox:_,toTop:D.alertToTop,jqm:D.jqModal});var u=e("#"+o(S.modalhead)).find(".ui-jqdialog-titlebar-close");u.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){u.focus()},50)}}(),j=function(t){var a;if(13===t.which&&(a=e(this).find(".ui-pg-button").filter(":focus")).length>0){var i=a[0].id,o=i.substr(0,e(this).closest(".ui-jqgrid-toppager").length>0?i.length-w.length-5:i.length-w.length-1)+"mod"+b.id,r=e(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(e.inArray(o,r)<0)return a.trigger("click"),!1}},q=f.call(g,"hover"),T=f.call(g,"disabled"),A=l.call(g,"navButton","ui-pg-button");if(g.grid){g.modalAlert=O,void 0===s&&(b.pager?(s=b.pager,b.toppager&&(D.cloneToTop=!0)):b.toppager&&(s=b.toppager));var G,I,B,N,P,R,M,z=1,V=["left","center","right"],L="<div class='"+l.call(g,"navButton","ui-pg-button "+f.call(g,"disabled"))+"'><span class='ui-separator'></span></div>",U=function(){d(this,T)||e(this).addClass(q)},H=function(){e(this).removeClass(q)},Q=function(){return d(this,T)||(e.isFunction(D.addfunc)?D.addfunc.call(g,p):r.editGridRow.call(y,"new",p)),!1},K=function(t,a,i){if(!d(this,T)){var o=b.selrow;o?e.isFunction(t)?t.call(g,o,i):r[a].call(y,o,i):O()}return!1},W=function(){return K.call(this,D.editfunc,"editGridRow",u)},J=function(){return K.call(this,D.viewfunc,"viewGridRow",v)},X=function(){var t;return d(this,T)||(b.multiselect?0===(t=b.selarrrow).length&&(t=null):t=b.selrow,t?e.isFunction(D.delfunc)?D.delfunc.call(g,t,h):r.delGridRow.call(y,t,h):O()),!1},Y=function(){return d(this,T)||(e.isFunction(D.searchfunc)?D.searchfunc.call(g,m):r.searchGrid.call(y,m)),!1},$=function(){if(!d(this,T)){e.isFunction(D.beforeRefresh)&&D.beforeRefresh.call(g),b.search=!1,b.resetsearch=!0;try{if("currentfilter"!==D.refreshstate){b.postData.filters="";try{e("#fbox_"+F).jqFilter("resetFilter")}catch(e){}e.isFunction(g.clearToolbar)&&g.clearToolbar(!1)}}catch(e){}switch(D.refreshstate){case"firstpage":y.trigger("reloadGrid",[e.extend({},D.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":y.trigger("reloadGrid",[e.extend({},D.reloadGridOptions||{},{current:!0})])}e.isFunction(D.afterRefresh)&&D.afterRefresh.call(g)}return!1},Z=function(t,a,i){var o=e("<div class='"+A+"' tabindex='0' role='button'></div>"),r=D[t+"icon"],l=e.trim(D[t+"text"]);return o.append("<div class='ui-pg-div'><span class='"+(D.iconsOverText?n("ui-pg-button-icon-over-text",E,r):n(E,r))+"'></span>"+(l?"<span class='ui-pg-button-text"+(D.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l+"</span>":"")+"</div>"),e(C).append(o),o.attr({title:D[t+"title"]||"",id:a||t+"_"+N}).click(i).hover(U,H),o};for(D.cloneToTop&&b.toppager&&(z=2),G=0;G<z;G++){if(C=e("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===b.direction?"right":"left")+";table-layout:auto;'></div>"),0===G?(N=w,(B=s)===b.toppager&&(N+="_top",z=1)):(B=b.toppager,N=w+"_top"),D.add&&Z("add",p.id,Q),D.edit&&Z("edit",u.id,W),D.view&&Z("view",v.id,J),D.del&&Z("del",h.id,X),(D.add||D.edit||D.del||D.view)&&e(C).append(L),D.search&&(I=Z("search",m.id,Y),m.showOnLoad&&!0===m.showOnLoad&&e(I,C).click()),D.refresh&&Z("refresh","",$),k=e(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",e("body").append("<div id='testpg2' class='"+l.call(g,"gBox","ui-jqgrid")+"' style='font-size:"+k+";visibility:hidden;' ></div>"),x=e(C).clone().appendTo("#testpg2").width(),e("#testpg2").remove(),e(B+"_"+D.position,B).append(C),D.hideEmptyPagerParts)for(P=0;P<V.length;P++)V[P]!==D.position&&(0===(M=e(B+"_"+V[P],B)).length||0===M[0].childNodes.length?M.hide():1===M[0].childNodes.length&&(R=M[0].firstChild,!e(R).is("table.ui-pg-table")||0!==R.rows&&0!==R.rows[0].cells.length||M.hide()));b._nvtd&&(x>b._nvtd[0]&&(e(B+"_"+D.position,B).width(x),b._nvtd[0]=x),b._nvtd[1]=x),g.nav=!0,C.on("keydown.jqGrid",j)}y.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(t,a){return"object"==typeof t&&(a=t,t=void 0),this.each(function(){var s=this,c=s.p;if(s.grid){var u=e.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},r.getGridRes.call(e(s),"nav"),i.nav||{},c.navOptions||{},a||{}),p=u.id,h=f.call(s,"hover"),m=f.call(s,"disabled"),v=l.call(s,"navButton","ui-pg-button");if(void 0===t)if(c.pager){if(r.navButtonAdd.call(e(s),c.pager,u),!c.toppager)return;t=c.toppager,p&&(p+="_top")}else c.toppager&&(t=c.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var g=e(".navtable",t),b=u.commonIconClass;if(g.length>0){if(p&&g.find("#"+o(p)).length>0)return;var y=e("<div tabindex='0' role='button'></div>");"NONE"===u.buttonicon.toString().toUpperCase()?e(y).addClass(v).append("<div class='ui-pg-div'>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"):e(y).addClass(v).append("<div class='ui-pg-div'><span class='"+(u.iconsOverText?n("ui-pg-button-icon-over-text",b,u.buttonicon):n(b,u.buttonicon))+"'></span>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"),p&&e(y).attr("id",p),"first"===u.position&&g.children("div.ui-pg-button").length>0?g.children("div.ui-pg-button").first().before(y):g.append(y),e(y,g).attr("title",u.title||"").click(function(t){return d(this,m)||e.isFunction(u.onClickButton)&&u.onClickButton.call(s,u,t),!1}).hover(function(){d(this,m)||e(this).addClass(h)},function(){e(this).removeClass(h)}),e(s).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(t,a){return a=e.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},a||{}),this.each(function(){if(this.grid){var i=this,n=i.p,d=l.call(i,"navButton","ui-pg-button "+f.call(i,"disabled"));if(void 0===t)if(n.pager){if(r.navSeparatorAdd.call(e(i),n.pager,a),!n.toppager)return;t=n.toppager}else n.toppager&&(t=n.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var s=e(".navtable",t);if(s.length>0){var c="<div class='"+d+"'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</div>";"first"===a.position?0===s.children("div.ui-pg-button").length?s.append(c):s.children("div.ui-pg-button").first().before(c):s.append(c)}}})},GridToForm:function(t,a){return this.each(function(){var i,l,n,d,s=this;if(s.grid){var c=r.getRowData.call(e(s),t);if(c)for(i in c)if(c.hasOwnProperty(i))if((l=e("[name="+o(i)+"]",a)).is("input:radio")||l.is("input:checkbox"))for(n=0;n<l.length;n++)(d=e(l[n])).prop("checked",d.val()===String(c[i]));else l.val(m(c[i])?"":c[i])}})},FormToGrid:function(t,a,i,o){return this.each(function(){var l=this;if(l.grid){i||(i="set"),o||(o="first");var n=e(a).serializeArray(),d={};e.each(n,function(e,t){d[t.name]=t.value}),"add"===i?r.addRowData.call(e(l),t,d,o):"set"===i&&r.setRowData.call(e(l),t,d)}})}})});
//# sourceMappingURL=grid.formedit.js.map